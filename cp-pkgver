#!/bin/bash

oldpkgver=$(grep -Po '(?<=^pkgver=)[^ ]*' "$2")
newpkgver=$(grep -Po '(?<=^pkgver=)[^ ]*' "$1")
if [ $newpkgver != $oldpkgver ]
then
  if [ -w "$2" ]
  then
    sed --follow-symlinks -i "s:^pkgver=[^ ]*:pkgver=$newpkgver:;s:^pkgrel=[^ ]*:pkgrel=1:" "$2"
  else
    printf "$0: $(gettext -d 'pacman-scripts' \
      "%s is not writeable -- pkgver will not be updated")\n" "$2"
    exit 2
  fi
fi
